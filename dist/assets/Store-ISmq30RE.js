import{i as Q,d as R,r as u,l as k,g as F,n as M,c as l,b as t,j as $,t as d,u as m,f as N,p as j,v as D,q as E,F as g,k as x,s as P,o as c}from"./index-BBIqiFrG.js";import{a as q}from"./index-Dq7h7Pqt.js";const z=Q("cart",{state:()=>({items:[]}),getters:{total:n=>n.items.reduce((o,i)=>o+i.price*i.quantity,0),itemCount:n=>n.items.reduce((o,i)=>o+i.quantity,0)},actions:{addItem(n){const o=this.items.find(i=>i.id===n.id);o?o.quantity++:this.items.push({...n,quantity:1})},updateQuantity(n,o){const i=this.items.find(r=>r.id===n);i&&(i.quantity=o)},removeItem(n){this.items=this.items.filter(o=>o.id!==n)},clearCart(){this.items=[]}}}),A={class:"min-h-screen bg-gray-50"},H={class:"bg-white shadow-sm"},G={class:"container mx-auto p-4"},J={class:"flex justify-between items-center"},K={class:"flex items-center space-x-4"},O=["src"],W={class:"text-xl font-bold"},X={class:"flex items-center space-x-4"},Y={class:"relative"},Z={key:0,class:"absolute -top-2 -right-2 bg-primary text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},tt=["href"],et={class:"container mx-auto p-4"},st={class:"flex space-x-4 mb-6"},at={class:"flex-1"},ot=["value"],nt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},it=["src","alt"],lt={class:"p-4"},ct={class:"font-semibold mb-2"},rt={class:"text-gray-600 text-sm mb-4"},dt={class:"flex justify-between items-center"},ut={class:"text-primary font-bold"},mt=["onClick"],pt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center"},_t={class:"bg-white rounded-lg p-6 w-full max-w-md"},ht={key:0,class:"text-center py-8"},ft={key:1,class:"space-y-4"},vt={class:"flex items-center space-x-4"},bt=["src","alt"],gt={class:"font-semibold"},xt={class:"text-primary"},yt={class:"flex items-center space-x-2"},wt=["onClick","disabled"],Ct={class:"w-8 text-center"},kt=["onClick"],$t=["onClick"],jt={class:"border-t pt-4"},qt={class:"flex justify-between font-bold mb-4"},Ut={class:"text-primary"},St=R({__name:"Store",setup(n){const o=M(),i=P(),r=z(),p=u({name:"",logoUrl:"",whatsapp:""}),f=u([]),y=u([]),_=u("all"),h=u(""),v=u(!1);u(!1);const U=k(()=>`https://wa.me/${p.value.whatsapp}?text=Hola, me gustaría hacer una consulta sobre tus productos.`),I=k(()=>f.value.filter(a=>{const s=a.name.toLowerCase().includes(h.value.toLowerCase())||a.description.toLowerCase().includes(h.value.toLowerCase()),e=!_.value||a.category_id===_.value;return s&&e}));F(async()=>{try{const a=await q.get(`undefined/api/stores/${o.params.slug}`);p.value=a.data;const s=await q.get(`undefined/api/stores/${o.params.slug}/products`);f.value=s.data,y.value=[...new Set(f.value.map(e=>e.category_id))]}catch(a){console.error("Error al cargar la tienda:",a)}});function w(){}const L=a=>{r.addItem({id:a.id,name:a.name,price:a.price,imageUrl:a.imageUrl||"",quantity:1})};function C(a,s){s>0&&r.updateQuantity(a,s)}function S(a){r.removeItem(a)}function T(){v.value=!0}function V(){v.value=!1}function B(){i.push({name:"checkout"})}return(a,s)=>(c(),l("div",A,[t("header",H,[t("div",G,[t("div",J,[t("div",K,[t("img",{src:p.value.logoUrl,alt:"Logo",class:"h-10 w-10 rounded-full"},null,8,O),t("h1",W,d(p.value.name),1)]),t("div",X,[t("button",{class:"btn btn-outline",onClick:T},[t("span",Y,[s[2]||(s[2]=t("i",{class:"fas fa-shopping-cart"},null,-1)),m(r).itemCount?(c(),l("span",Z,d(m(r).itemCount),1)):$("",!0)])]),t("a",{href:U.value,target:"_blank",class:"btn btn-success"},s[3]||(s[3]=[t("i",{class:"fab fa-whatsapp"},null,-1),N(" Contactar ")]),8,tt)])])])]),t("div",et,[t("div",st,[t("div",at,[j(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>h.value=e),type:"text",placeholder:"Buscar productos...",class:"input w-full",onInput:w},null,544),[[D,h.value]])]),j(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>_.value=e),class:"input",onChange:w},[s[4]||(s[4]=t("option",{value:""},"Todas las categorías",-1)),(c(!0),l(g,null,x(y.value,e=>(c(),l("option",{key:e,value:e},d(e),9,ot))),128))],544),[[E,_.value]])]),t("div",nt,[(c(!0),l(g,null,x(I.value,e=>(c(),l("div",{key:e.id,class:"bg-white rounded-lg shadow-sm overflow-hidden"},[t("img",{src:e.imageUrl,alt:e.name,class:"w-full h-48 object-cover"},null,8,it),t("div",lt,[t("h2",ct,d(e.name),1),t("p",rt,d(e.description),1),t("div",dt,[t("span",ut,"$"+d(e.price),1),t("button",{class:"btn btn-primary btn-sm",onClick:b=>L(e)}," Agregar al carrito ",8,mt)])])]))),128))])]),v.value?(c(),l("div",pt,[t("div",_t,[t("div",{class:"flex justify-between items-center mb-4"},[s[5]||(s[5]=t("h2",{class:"text-xl font-bold"},"Carrito de Compras",-1)),t("button",{class:"btn btn-sm btn-outline",onClick:V},"Cerrar")]),m(r).items.length===0?(c(),l("div",ht,s[6]||(s[6]=[t("p",{class:"text-gray-500"},"Tu carrito está vacío",-1)]))):(c(),l("div",ft,[(c(!0),l(g,null,x(m(r).items,e=>(c(),l("div",{key:e.id,class:"flex items-center justify-between"},[t("div",vt,[t("img",{src:e.imageUrl,alt:e.name,class:"w-16 h-16 object-cover rounded"},null,8,bt),t("div",null,[t("h3",gt,d(e.name),1),t("p",xt,"$"+d(e.price),1)])]),t("div",yt,[t("button",{class:"btn btn-sm btn-outline",onClick:b=>C(e.id,e.quantity-1),disabled:e.quantity<=1},"-",8,wt),t("span",Ct,d(e.quantity),1),t("button",{class:"btn btn-sm btn-outline",onClick:b=>C(e.id,e.quantity+1)},"+",8,kt),t("button",{class:"btn btn-sm btn-danger ml-2",onClick:b=>S(e.id)},"×",8,$t)])]))),128)),t("div",jt,[t("div",qt,[s[7]||(s[7]=t("span",null,"Total:",-1)),t("span",Ut,"$"+d(m(r).total),1)]),t("button",{class:"btn btn-success w-full",onClick:B},"Finalizar Compra")])]))])])):$("",!0)]))}});export{St as default};
