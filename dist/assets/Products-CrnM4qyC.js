import{i as N,d as V,c as i,j as f,f as B,t as g,m as $,o as n,r as c,g as D,b as t,F as I,k as F,w as L,e as h}from"./index-BBIqiFrG.js";import{a as y}from"./index-Dq7h7Pqt.js";const G=N("products",{state:()=>({products:[],loading:!1,error:null}),actions:{async fetchProducts(){this.loading=!0;try{const e=await y.get("undefined/api/stores/undefined/products");return this.products=e.data,this.products}catch(e){throw this.error="Error al cargar productos",e}finally{this.loading=!1}},async createProduct(e){this.loading=!0;try{const a=await y.post("undefined/api/products",e);return this.products.push(a.data),a.data}catch(a){throw this.error="Error al crear producto",a}finally{this.loading=!1}},async updateProduct(e,a){this.loading=!0;try{const d=await y.put(`undefined/api/products/${e}`,a),u=this.products.findIndex(b=>b.id===e);return u!==-1&&(this.products[u]=d.data),d.data}catch(d){throw this.error="Error al actualizar producto",d}finally{this.loading=!1}},async deleteProduct(e){this.loading=!0;try{await y.delete(`undefined/api/products/${e}`),this.products=this.products.filter(a=>a.id!==e)}catch(a){throw this.error="Error al eliminar producto",a}finally{this.loading=!1}}}}),R={class:"relative"},z=["for"],O={key:0,class:"text-red-500"},T=["id","value","placeholder","disabled","required"],A=["id","type","value","placeholder","disabled","required"],H={key:3,class:"mt-1 text-sm text-red-600"},J={key:4,class:"mt-1 text-sm text-gray-500"},k=V({__name:"Input",props:{id:{type:String,required:!0},label:{type:String,default:""},type:{type:String,default:"text",validator:e=>["text","email","password","number","tel","url","textarea"].includes(e)},modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},error:{type:String,default:""},hint:{type:String,default:""}},emits:["update:modelValue"],setup(e){return(a,d)=>(n(),i("div",R,[e.label?(n(),i("label",{key:0,for:e.id,class:"block text-sm font-medium text-gray-700 mb-1"},[B(g(e.label)+" ",1),e.required?(n(),i("span",O,"*")):f("",!0)],8,z)):f("",!0),e.type==="textarea"?(n(),i("textarea",$({key:1,id:e.id,value:e.modelValue,placeholder:e.placeholder,disabled:e.disabled,required:e.required,class:["block w-full rounded-md shadow-sm focus:ring-2 focus:ring-offset-2 transition-colors",{"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500":!e.error,"border-red-300 focus:border-red-500 focus:ring-red-500":e.error,"bg-gray-50 cursor-not-allowed":e.disabled}],onInput:d[0]||(d[0]=u=>a.$emit("update:modelValue",u.target.value))},a.$attrs),null,16,T)):(n(),i("input",$({key:2,id:e.id,type:e.type,value:e.modelValue,placeholder:e.placeholder,disabled:e.disabled,required:e.required,class:["block w-full rounded-md shadow-sm focus:ring-2 focus:ring-offset-2 transition-colors",{"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500":!e.error,"border-red-300 focus:border-red-500 focus:ring-red-500":e.error,"bg-gray-50 cursor-not-allowed":e.disabled}],onInput:d[1]||(d[1]=u=>a.$emit("update:modelValue",u.target.value))},a.$attrs),null,16,A)),e.error?(n(),i("p",H,g(e.error),1)):f("",!0),e.hint?(n(),i("p",J,g(e.hint),1)):f("",!0)]))}}),K={class:"container mx-auto p-4"},Q={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},W=["src"],X={class:"text-lg font-semibold"},Y={class:"text-gray-600"},Z={class:"text-primary font-bold mt-2"},_={class:"flex justify-between mt-4"},ee=["onClick"],te=["onClick"],ae={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center"},re={class:"bg-white rounded-lg p-6 w-full max-w-md"},le={class:"text-xl font-bold mb-4"},oe={key:0,class:"mt-2"},se=["src"],ie={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center"},ue=V({__name:"Products",setup(e){const a=G(),d=c([]),u=c(!1),b=c(!1),v=c(!1),m=c(null),w=c(!1);c(!1);const s=c({name:"",description:"",price:0,stock:0,min_stock:5,category_id:"",sku:"",is_active:!0,imageUrl:""});D(async()=>{await p()});const p=async()=>{try{w.value=!0,d.value=await a.fetchProducts()}catch(l){console.error("Error al cargar productos:",l)}finally{w.value=!1}};function C(){v.value=!1,s.value={name:"",description:"",price:0,stock:0,min_stock:5,category_id:"",sku:"",is_active:!0,imageUrl:""},u.value=!0}function E(l){v.value=!0,m.value=l,s.value={name:l.name,description:l.description,price:l.price,stock:l.stock,min_stock:l.min_stock,category_id:l.category_id,sku:l.sku,is_active:l.is_active,imageUrl:l.imageUrl||""},u.value=!0}function U(l){m.value=l,b.value=!0}function x(){u.value=!1,s.value={name:"",description:"",price:0,stock:0,min_stock:5,category_id:"",sku:"",is_active:!0,imageUrl:""}}function P(){b.value=!1,m.value=null}function q(l){var o;const r=(o=l.target.files)==null?void 0:o[0];r&&(s.value.imageUrl=URL.createObjectURL(r))}async function S(){v.value&&m.value?await a.updateProduct(m.value.id,s.value):await a.createProduct(s.value),x(),await p()}async function j(){m.value&&await a.deleteProduct(m.value.id),P(),await p()}return(l,r)=>(n(),i("div",K,[t("div",{class:"flex justify-between items-center mb-6"},[r[3]||(r[3]=t("h1",{class:"text-2xl font-bold"},"Gestión de Productos",-1)),t("button",{class:"btn btn-primary",onClick:C},"Nuevo Producto")]),t("div",Q,[(n(!0),i(I,null,F(d.value,o=>(n(),i("div",{key:o.id,class:"bg-white rounded-lg shadow p-4"},[t("img",{src:o.imageUrl||"/placeholder.jpg",alt:"Producto",class:"w-full h-40 object-cover rounded-lg mb-4"},null,8,W),t("h2",X,g(o.name),1),t("p",Y,g(o.description),1),t("p",Z,"$"+g(o.price),1),t("div",_,[t("button",{class:"btn btn-sm btn-outline",onClick:M=>E(o)},"Editar",8,ee),t("button",{class:"btn btn-sm btn-danger",onClick:M=>U(o)},"Eliminar",8,te)])]))),128))]),u.value?(n(),i("div",ae,[t("div",re,[t("h2",le,g(v.value?"Editar Producto":"Nuevo Producto"),1),t("form",{onSubmit:L(S,["prevent"]),class:"space-y-4"},[h(k,{id:"product-name",modelValue:s.value.name,"onUpdate:modelValue":r[0]||(r[0]=o=>s.value.name=o),label:"Nombre",required:""},null,8,["modelValue"]),h(k,{id:"product-description",modelValue:s.value.description,"onUpdate:modelValue":r[1]||(r[1]=o=>s.value.description=o),label:"Descripción",required:""},null,8,["modelValue"]),h(k,{id:"product-price",modelValue:s.value.price,"onUpdate:modelValue":r[2]||(r[2]=o=>s.value.price=o),modelModifiers:{number:!0},type:"number",label:"Precio",min:"0",required:""},null,8,["modelValue"]),t("div",null,[r[4]||(r[4]=t("label",{class:"block text-sm font-medium mb-1"},"Imagen",-1)),t("input",{type:"file",accept:"image/*",class:"input",onChange:q},null,32),s.value.imageUrl?(n(),i("div",oe,[t("img",{src:s.value.imageUrl,alt:"Preview",class:"h-20 rounded-lg border"},null,8,se)])):f("",!0)]),t("div",{class:"flex justify-end space-x-2"},[t("button",{type:"button",class:"btn btn-outline",onClick:x},"Cancelar"),r[5]||(r[5]=t("button",{type:"submit",class:"btn btn-primary"},"Guardar",-1))])],32)])])):f("",!0),b.value?(n(),i("div",ie,[t("div",{class:"bg-white rounded-lg p-6 w-full max-w-md"},[r[6]||(r[6]=t("h2",{class:"text-xl font-bold mb-4"},"Eliminar Producto",-1)),r[7]||(r[7]=t("p",null,"¿Estás seguro de que deseas eliminar este producto?",-1)),t("div",{class:"flex justify-end space-x-2 mt-4"},[t("button",{class:"btn btn-outline",onClick:P},"Cancelar"),t("button",{class:"btn btn-danger",onClick:j},"Eliminar")])])])):f("",!0)]))}});export{ue as default};
